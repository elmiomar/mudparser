# RFC 8520 Compliance

MudParser provides comprehensive support for RFC 8520 - Manufacturer Usage Description Specification.

## Overview

RFC 8520 defines the MUD architecture that allows IoT manufacturers to specify the network behavior their devices require. This enables automated policy configuration in the network.

## Supported Features

### MUD Container (ietf-mud:mud)

| Field | Status | Notes |
|-------|--------|-------|
| `mud-version` | ✅ Supported | Only version 1 is supported |
| `mud-url` | ✅ Supported | Validated for HTTPS |
| `last-update` | ✅ Supported | Parsed as datetime |
| `cache-validity` | ✅ Supported | Validated 1-168 hours |
| `is-supported` | ✅ Supported | Boolean |
| `systeminfo` | ✅ Supported | Max 60 characters |
| `mfg-name` | ✅ Supported | Optional |
| `model-name` | ✅ Supported | Optional |
| `firmware-rev` | ✅ Supported | Optional |
| `software-rev` | ✅ Supported | Optional |
| `documentation` | ✅ Supported | Optional URL |
| `extensions` | ✅ Supported | List of extension names |
| `from-device-policy` | ✅ Supported | Outbound policy |
| `to-device-policy` | ✅ Supported | Inbound policy |
| `mud-signature` | ⚠️ Parsed | Signature validation not implemented |

### ACL Model (RFC 8519)

| Feature | Status |
|---------|--------|
| IPv4 ACL type | ✅ Supported |
| IPv6 ACL type | ✅ Supported |
| Ethernet ACL type | ✅ Supported |
| Mixed ACL types | ✅ Supported |
| ACE ordering | ✅ Preserved |

### Match Types

#### IPv4/IPv6 Matches

| Field | Status |
|-------|--------|
| `protocol` / `next-header` | ✅ Supported |
| `source-network` | ✅ Supported |
| `destination-network` | ✅ Supported |
| `dscp` | ✅ Supported |
| `ecn` | ✅ Supported |
| `length` | ✅ Supported |
| `ttl` / `hop-limit` | ✅ Supported |

#### TCP Matches

| Field | Status |
|-------|--------|
| `source-port` | ✅ Supported |
| `destination-port` | ✅ Supported |
| `direction-initiated` | ✅ Supported |
| `flags` | ✅ Supported |

#### UDP Matches

| Field | Status |
|-------|--------|
| `source-port` | ✅ Supported |
| `destination-port` | ✅ Supported |
| `length` | ✅ Supported |

#### ICMP Matches

| Field | Status |
|-------|--------|
| `type` | ✅ Supported |
| `code` | ✅ Supported |

#### Ethernet Matches

| Field | Status |
|-------|--------|
| `source-mac-address` | ✅ Supported |
| `destination-mac-address` | ✅ Supported |
| `ethertype` | ✅ Supported |

### Port Operators

| Operator | Status |
|----------|--------|
| `eq` (equals) | ✅ Supported |
| `neq` (not equals) | ✅ Supported |
| `lt` (less than) | ✅ Supported |
| `gt` (greater than) | ✅ Supported |
| `range` | ✅ Supported |

### MUD-Specific Matches

| Match Type | Status | Description |
|------------|--------|-------------|
| `manufacturer` | ✅ Supported | Match by manufacturer URL authority |
| `same-manufacturer` | ✅ Supported | Match same manufacturer devices |
| `model` | ✅ Supported | Match same model (MUD URL) |
| `local-networks` | ✅ Supported | Match local network traffic |
| `controller` | ✅ Supported | Match controller class |
| `my-controller` | ✅ Supported | Match device-specific controller |

### DNS Extension (ietf-acldns)

| Field | Status |
|-------|--------|
| `src-dnsname` | ✅ Supported |
| `dst-dnsname` | ✅ Supported |

### Actions

| Action | Status |
|--------|--------|
| `accept` | ✅ Supported |
| `drop` | ✅ Supported |
| `reject` | ✅ Supported (treated as drop) |

## Standard Controller URNs

MudParser recognizes these standard controller URNs:

- `urn:ietf:params:mud:dns` - DNS server
- `urn:ietf:params:mud:ntp` - NTP server

## Validation

MudParser validates profiles against RFC 8520 requirements:

1. **Required fields** - All mandatory fields must be present
2. **Version check** - Only MUD version 1 is supported
3. **URL validation** - MUD URL should use HTTPS
4. **Cache validity** - Must be 1-168 hours
5. **ACL references** - All referenced ACLs must exist
6. **Semantic checks** - direction-initiated only for TCP

## Limitations

The following RFC 8520 features are not fully implemented:

1. **Signature verification** - The `mud-signature` URL is parsed but signatures are not verified
2. **MUD URL delivery** - DHCP/LLDP/X.509 delivery mechanisms are out of scope
3. **MUD manager** - This library is a parser, not a full MUD manager implementation

## References

- [RFC 8520 - Manufacturer Usage Description Specification](https://datatracker.ietf.org/doc/rfc8520/)
- [RFC 8519 - YANG Data Model for Network Access Control Lists](https://datatracker.ietf.org/doc/rfc8519/)
